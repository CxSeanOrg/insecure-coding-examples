# -----------------------------------------------------------------
# FORMAT: Hacking, the Art of Exploitation (Jon Erickson)
# -----------------------------------------------------------------

add_executable(getenvaddr getenvaddr.c)

add_executable(format_exploitable exploitable.c)
target_compile_options(format_exploitable PRIVATE -Wno-format-security)

add_executable(format_exploitable_simple exploitable_simple.c)
target_compile_options(format_exploitable_simple PRIVATE -Wno-format-security)

add_executable(chars_written chars_written.c)
add_executable(direct_access direct_access.c)
add_executable(field_width field_width.c)

# Shellcode test
add_executable(environment_variable_shellcode environment_variable_shellcode.c)
# remove the stack protector
# *** stack smashing detected ***: <unknown> terminated
# Aborted (core dumped)
target_compile_options(environment_variable_shellcode PRIVATE -fno-stack-protector)
# Make the stack executable - otherwise Segmentation fault (core dumped)
set_target_properties(environment_variable_shellcode PROPERTIES LINK_FLAGS "-z execstack")
